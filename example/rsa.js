const NodeRSA = require('node-rsa');

const RSA_TEST_PRIVATE_KEY = `-----BEGIN PRIVATE KEY-----
MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC6HH82NIk1cm+OGE1mvNewjM4wJjwmI4lfctbY+6+5LGw9qfJ6jQX0/na8eSBQPnhooiTIqxNHKTarP5q9Ca4wih9ns4qOT6o9U00fsx4fgTLNArdVAETuhpbxgnfCnMZ/H7ktoacKVQQYArU1GGiWCSAgB47QOBW6dJlXlfPFSe29nIEPc+mm+UXW2xq/iZfxY9f92ALvMw84hoQv7CmpkAi1qw/8n+DD03ruxBZz0FI7fxgqY/vrKXqFu/0n7H2jAokTGKZHGUHwPNvLrDJ0P7Y1+h2/C1Y8n40EiEf+TutSWfhTUwnU5Rz82m4IMThSqxrj6QN2QXJ49wB56XObAgMBAAECggEAQaED8RL0oZ7RnNuQC98i9lSo7wzEoDRe4IRIJCsY6+Uw5EvWQIYTaDIFn+/cx79HyaoH66V8PldXumrK/8d2oBJNAc4r2YRZRZfm9fs9b6GpTucazEQ0iqJ2fwLhhYSwcKq4q9E57OhO8cKesPMDCol8RR81KtLkQqSUYHD2DgcpINaL1SFZNn9RcrOs53Ma1b27WOt+TivUDOLsAt9AvtVuzr5S2jUjnLVvNngGbmamotfuhDYAV9SzeYiwFOpfPnsw+4Lq7egWVXGfUZcR962xxzjvDaGuNUsif8rcTMxKl9aywYWfPNMUByeCmspbf+eWqp11VHWevrDVfyxQEQKBgQD5Ba6uzKb25dS3lkU3acigKHFKk5JXtSdraO0cEEcYHCqVJFBUBW3zZ0eMFQkFY4WJFJDGIy11A9w3LVvd3PbT2Hm/H5zXgzIAhCGS4YLmcBVn3Zrg8HHdlYxknUaJ57JjQceAtQ/RcidMdcGdx6IX+4sOTv99qEpyXT8Yn0OZ6wKBgQC/U4jEfXD8qMGGpcZFqoFl7Wsgfb37RkBGv7WTxSbvwTmAQqTRTjZSQSWH0oiPqnxu9LYtVr9JIh8P6T3TbeoO31O1DqbPYclmWQx4v9HkOygDdtIpHGt91kmktnGfbi0DSUdaAwzLhmPWAiRokOy5wFdVsdEagvS+cz5/UBLxEQKBgQDelXCtN6op2AcJzhyySjCUz3FsWnmdQgQpItGFmxsg9tQtGRdf8rZzsSYnlQnKMknC3IoHQJw6Eqg8/aM2rXJGqyEvb39OtyrzgSdNVZsehKLtgwwT8Xeluy2RJW9OhrZRuBMt/SlVafashjj44d8GFsYVlRETbWCV1rk2Ne1D3wKBgEsscTJy7y/2xoM3I15ADjOUQ2EyxrCx+5NQw/FZp2DQlN02UjgC+Qj8m9hv+kQogle+Qs4xpVsA0x+XTzmBmFNboDIlnZkiHNXf6yyOgdOhAqnJx+1rQzjgN3NGVAKGcZ0275gIVsCo/xUZJmEHgFvDnQ0IntZB2hPyh/3R4n9hAoGBAIZZHGa9X8PzspJUjyuvn2k/HQIj8hsymtCJPbzTc4NSqlIj2EfrN07WhoaT81bfZ4NGMgIE/2UCbk4iUJNJUJrg8UHQscIXJajd4pBESbVcPgPH2nbNpW5qKDrL5fWA4AGjoWqeGnnb1aUPMllS1rbjVdnb3RzVblre6V4lGNaD
-----END PRIVATE KEY-----`

const key = new NodeRSA(RSA_TEST_PRIVATE_KEY);
const pubkey = key.exportKey('components-public');
console.log(pubkey.n.slice(1).toString('hex'));
console.log(pubkey.e);

const message = "bf23720fff6daca1cc7b564703cd98b3fc8b7440a9c0d08a516c7dc08c4c7449"
const signature = "b3642c24811b9c15f1b1639c70e85308127193d305955d9d4f557a296dfeb7793efec257bdea3a955cde06490d06609fa677af363d9db9b9915447126897b5f2b3345582c7d2c746b6e2baefcb77608a13eaf8bca31c483489e6a76394f38a63c7426fc7e6e90d1596dedf7e579cc4e96d6d8cc76ebc7eb0c41cf6dd58b57aa33da0c3d247f0484a7365c6a066144fd4003d0b03e41ce9ddd7cdf7686bd3eac22f761ce2c10b891aa957b71fc9e5839452a36128b79ba4613cf1bc491899ccdd93e5c8631cbcafd7c29726fa7d62c3584ed9c8b83c27f573568799463d1873f5d310e677505807348b5173e2f3dea7771ba12de47ad18f44de6ac78896e61caa"

const n = "db8561491037e41ded510ab536afe67c6b3c3d22cd8294322d9a3e1bed1f125ceba263460340e71b1ac39323218022d769596dcc35dff65eabd873764b255b3baef41f3c4a6c95f6c0975cd4b9b1fceabff4fc1186cf81043d0bda23b9256eb30adc7b277934c05788db98fa3fb2598d69eac45e3a87cb646fb2e55688653b2fe2e01b8aba1f101100ab759f38d83c4cb71ee1dacb69929c54f38f7c78a37581c9de7ada3e5a9001d81db6051fc2e882d32038b272527fc297f995e724438cc8b7424af1d662b56c901565f740a940da46cf67496b21d93b679cd76be444b54b3e19cc4bcd32b8120cab05be13f5ec603cca927f8a63e496eb364920d7aa55d3"
const e = "01000100"

const eBuffer = Buffer.from(e, 'hex').reverse()
const nBuffer = Buffer.from(n, 'hex').reverse()

const verifyKey = new NodeRSA()
verifyKey.importKey({ e: eBuffer, n: nBuffer }, 'components-public')
verifyKey.setOptions({ signingScheme: 'pkcs1-sha256' })
const result = verifyKey.verify(
    Buffer.from(message),
    signature
)

console.log(result)